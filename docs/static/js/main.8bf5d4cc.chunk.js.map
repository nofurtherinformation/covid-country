{"version":3,"sources":["components/Map.js","App.js","reportWebVitals.js","index.js"],"names":["DATA_URL","state_boundaries","process","county_boundaries","MapContainer","styled","div","dirLight","IcoSphereGeometry","iterations","DirectionalLight","color","intensity","direction","_shadow","ambientLight","AmbientLight","colors","breaks","colorScale","d3","domain","range","Map","useState","latitude","longitude","zoom","pitch","bearing","initialViewState","lightingEffect","LightingEffect","shadowColor","effects","currDate","setCurrDate","timerId","setTimerId","centroidData","setCentroidData","useEffect","document","addEventListener","event","preventDefault","then","data","layers","SolidPolygonLayer","coordinateSystem","COORDINATE_SYSTEM","METER_OFFSETS","id","opacity","getPolygon","d","stroked","filled","getFillColor","PolygonLayer","lineWidthMinPixels","getLineColor","getLineWidth","ColumnLayer","diskResolution","radius","material","extruded","pickable","elevationScale","getPosition","x","y","val","r","g","b","handleColor","getElevation","updateTriggers","transitions","Button","onClick","setInterval","t","a","moment","add","format","slice","href","target","rel","src","alt","reverse","map","item","index","parseInt","style","backgroundColor","controller","App","className","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8bf5d4cc.chunk.js","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport DeckGL from '@deck.gl/react';\r\nimport {LightingEffect, DirectionalLight, AmbientLight } from '@deck.gl/core';\r\nimport {SolidPolygonLayer, ScatterplotLayer, PolygonLayer, ColumnLayer } from '@deck.gl/layers';\r\nimport {COORDINATE_SYSTEM} from '@deck.gl/core';\r\nimport {SimpleMeshLayer} from '@deck.gl/mesh-layers';\r\nimport {SphereGeometry, IcoSphereGeometry} from '@luma.gl/core'\r\nimport styled from 'styled-components';\r\nimport Button from '@material-ui/core/Button';\r\nimport * as moment from 'moment';\r\nimport * as d3 from 'd3';\r\n\r\nconst DATA_URL = {\r\n    state_boundaries: `${process.env.PUBLIC_URL}/data/state_borders.json`,\r\n    county_boundaries: `${process.env.PUBLIC_URL}/data/county_borders.json`\r\n}\r\n\r\nconst MapContainer = styled.div`\r\n    position:fixed;\r\n    width:100%;\r\n    height:100%;\r\n    top:0;\r\n    left:0;\r\n    overflow:visible;\r\n    background:rgb(15,15,15);\r\n`\r\n\r\nconst geom = new IcoSphereGeometry({\r\n    iterations: 1\r\n  });\r\n\r\nconst dirLight = new DirectionalLight({\r\n    color: [128, 128, 0],\r\n    intensity: 5.0,\r\n    direction: [0, -100, -100],\r\n    _shadow: true\r\n  });\r\n\r\nconst ambientLight = new AmbientLight({\r\n    color: [180,220,220],\r\n    intensity: 3\r\n});\r\n\r\nconst colors = [\r\n    '#0D0887',\r\n    '#5C01A6',\r\n    '#9C179E',\r\n    '#CB4679',\r\n    '#ED7953',\r\n    '#FDB42F',\r\n    '#F0F921',\r\n    '#F0F921'\r\n]\r\n\r\nconst breaks = [\r\n    0,\r\n    .03,\r\n    .05,\r\n    .10,\r\n    .15,\r\n    .20,\r\n    .25,\r\n    1000\r\n]\r\n\r\nconst colorScale = d3.scaleLinear()\r\n    .domain(breaks)\r\n    .range(colors)\r\n\r\nconst handleColor = (val) => {\r\n    let color = d3.color(colorScale(val))\r\n    if (color === null) return [240,240,240]\r\n    return [color.r, color.g, color.b, 150]\r\n}\r\n\r\n/* eslint-disable react/no-deprecated */\r\nconst Map = () => {\r\n\r\n    const timeInterval = 175;\r\n\r\n    const [initialViewState, setInitialViewState] = useState({\r\n        latitude: 0,\r\n        longitude: 0,\r\n        zoom: 4.75,\r\n        pitch:40,\r\n        bearing:0\r\n    });\r\n\r\n    const [effects] = useState(() => {\r\n        const lightingEffect = new LightingEffect({dirLight, ambientLight});\r\n        lightingEffect.shadowColor = [0, 0, 0, 0.15];\r\n        return [lightingEffect];\r\n        });\r\n    \r\n    const [currDate, setCurrDate] = useState(['2020-02-01'])\r\n    const [timerId, setTimerId] = useState(null)\r\n    const [centroidData, setCentroidData] = useState([])\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('contextmenu', event => event.preventDefault());\r\n\r\n        d3.csv(`${process.env.PUBLIC_URL}/data/centroids_testing_albers.csv`, d3.autoType)\r\n            .then(data => { setCentroidData(data) })\r\n    },[])\r\n    \r\n    const PlayAnimation = () => {\r\n        setCurrDate(['2020-02-01'])\r\n        if (timerId === null) {\r\n            setTimerId(setInterval(() => {\r\n                setCurrDate(t => {\r\n                    if (t < '2021-01-19') {\r\n                        var a = moment(t, 'YYYY-MM-DD')\r\n                        a = a.add(1, 'day')\r\n                        return a.format().slice(0,10)\r\n                    } else {\r\n                        return t\r\n                    }\r\n                })\r\n            },timeInterval))\r\n        };\r\n    }\r\n\r\n    const layers =  [ \r\n        new SolidPolygonLayer({\r\n            coordinateSystem: COORDINATE_SYSTEM.METER_OFFSETS,\r\n            id: 'background',\r\n            data: [\r\n                [[-400_000, 240_000], [440_000, 240_000], [440_000, -240_000], [-400_000, -240_000]]\r\n            ],\r\n            opacity: 1,\r\n            getPolygon: d => d,\r\n            stroked: false,\r\n            filled: true,\r\n            getFillColor: [15,15,15],\r\n        }),\r\n        new PolygonLayer({\r\n            id: 'county-layer',\r\n            coordinateSystem: COORDINATE_SYSTEM.METER_OFFSETS,\r\n            data: DATA_URL.county_boundaries,\r\n            getPolygon: d=> d,\r\n            stroked: true,\r\n            filled: false,\r\n            lineWidthMinPixels: 1,\r\n            getLineColor: [240, 240, 240, 10],\r\n            getLineWidth: 1\r\n        }),\r\n        new PolygonLayer({\r\n            id: 'polygon-layer',\r\n            coordinateSystem: COORDINATE_SYSTEM.METER_OFFSETS,\r\n            data: DATA_URL.state_boundaries,\r\n            getPolygon: d=> d,\r\n            stroked: true,\r\n            filled: false,\r\n            lineWidthMinPixels: 1,\r\n            getLineColor: [240, 240, 240, 25],\r\n            getLineWidth: 1\r\n        }),\r\n        // new SimpleMeshLayer({\r\n        //     id: 'mesh-layer',\r\n        //     coordinateSystem: COORDINATE_SYSTEM.METER_OFFSETS,\r\n        //     data: centroidData,\r\n        //     mesh: geom,\r\n        //     wireframe: true,\r\n        //     getPosition: d => [d.x,d.y],\r\n        //     getColor: d => {\r\n        //         let tempVal = d[`pos_${currDate}`]*(counter/100)+(d[`pos_${currDate}`]*((100-counter)/100))\r\n        //         return handleColor(tempVal)\r\n        //     },\r\n        //     getScale: d => [2500, 2500, (d[`pos_${currDate}`]*(counter/100)+(d[`pos_${currDate}`]*((100-counter)/100)))*500000],\r\n        //     getTranslation: d => [0, 0, (d[`pos_${currDate}`]*(counter/100)+(d[`pos_${currDate}`]*((100-counter)/100)))*500000],\r\n        //     // getScale: d => [(d[`tcap_${currDate}`]*(counter/100)+(d[`tcap_${currDate}`]*((100-counter)/100)))*20,\r\n        //     //                 (d[`tcap_${currDate}`]*(counter/100)+(d[`tcap_${currDate}`]*((100-counter)/100)))*20, \r\n        //     //                 (d[`tcap_${currDate}`]*(counter/100)+(d[`tcap_${currDate}`]*((100-counter)/100)))*100], \r\n        //     updateTriggers: {\r\n        //         getTranslation: [currDate],\r\n        //         getScale: [currDate, counter],\r\n        //         getColor: [currDate, counter]\r\n        //     }\r\n        // }),\r\n        new ColumnLayer({\r\n            id: 'line-layer',\r\n            coordinateSystem: COORDINATE_SYSTEM.METER_OFFSETS,\r\n            data: centroidData,\r\n            diskResolution: 6,\r\n            radius: 5000,\r\n            material:false,\r\n            extruded: true,\r\n            pickable: true,\r\n            elevationScale: 5000,\r\n            getPosition: d => [d.x,d.y],\r\n            getFillColor: d => handleColor(d[`pos_${currDate}`]),\r\n            getLineColor: [0, 0, 0],\r\n            getElevation: d => [(d[`pos_${currDate}`])*250],\r\n            updateTriggers: {\r\n                getFillColor: currDate,\r\n                getElevation: currDate,\r\n            },\r\n            transitions: {\r\n                getFillColor: timeInterval,\r\n                getElevation: timeInterval,\r\n            }\r\n        })\r\n    ]\r\n\r\n    return (\r\n        <MapContainer>\r\n            <Button onClick={PlayAnimation} id=\"playButton\">{timerId === null ? 'Play' : 'Reset' }</Button>\r\n            <div id=\"title\">\r\n                <h1>COVID Testing Positivity Rates</h1>\r\n                <h2>7-Day Rolling Average of {currDate}</h2>\r\n            </div>\r\n            <div id=\"logo\">\r\n                <a href=\"https://theuscovidatlas.org/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                    <img src={`${process.env.PUBLIC_URL}/logo.svg`} alt=\"US Covid Atlas Logo\" />\r\n                </a>\r\n            </div>\r\n            <div id=\"attribution\">\r\n                <a href=\"https://theuscovidatlas.org/\" target=\"_blank\" rel=\"noopener noreferrer\">  \r\n                    <p>Learn more at USCovidAtlas.org</p>\r\n                </a>\r\n                <p>Testing data from CDC. State and County boundaries from US Census.</p>\r\n            </div>\r\n            <div id=\"scale\">\r\n                <div id=\"breaks\">\r\n                    {breaks.slice(1,-1).reverse().map((item, index) => <p>{index===0 ? '>' : ''}{parseInt(item*100)}%</p>)}\r\n                </div>\r\n                <div id=\"colors\">\r\n                    {colors.slice(0,-1).reverse().map(item => <span style={{backgroundColor: item}}></span>)}\r\n                </div>\r\n            </div>\r\n            <DeckGL \r\n                layers={layers} \r\n                initialViewState={initialViewState} \r\n                effects={effects}\r\n                controller={true}>\r\n            </DeckGL>\r\n        </MapContainer>\r\n    )\r\n}\r\n\r\nexport default Map","import React, {useState, useCallback} from 'react';\nimport Map from './components/Map';\nimport './App.css';\n\n\nfunction App() {  \n  return (\n    <div className=\"App\">\n      <Map />\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}